# Apache configuration for SPA routing
<IfModule mod_rewrite.c>
  RewriteEngine On
  
  # Handle Angular and React client-side routing
  # If the requested resource doesn't exist as a file or directory
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Exclude API routes and static assets
  RewriteCond %{REQUEST_URI} !^/api/
  RewriteCond %{REQUEST_URI} !^/assets/
  RewriteCond %{REQUEST_URI} !^/lovable-uploads/
  
  # Redirect everything else to index.html
  RewriteRule . /index.html [L]
</IfModule>

# Security headers
<IfModule mod_headers.c>
  Header always set X-Frame-Options "DENY"
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Permissions-Policy "camera=(), microphone=(), geolocation=()"
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  
  # Set proper MIME types
  <FilesMatch "\.(xml)$">
    Header set Content-Type "application/xml"
  </FilesMatch>
  
  <FilesMatch "\.(txt)$">
    Header set Content-Type "text/plain"
  </FilesMatch>
</IfModule>